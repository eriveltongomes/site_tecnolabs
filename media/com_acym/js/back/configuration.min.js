jQuery(function(e){function t(t,i){let n=e(`#${t}`).val();n=acym_helper.parseJson(n);let a=e(".acym__sending__methods__choose .acym__selection__card-selected");if(0===a.length)return;let c=e(`[name="config[${i}]"]`),l=c.closest(".acym__configuration__mail__option").find(".acym__configuration__mail__info__disabled"),o=c.closest(".acym__configuration__mail__option").find("> .switch-label"),_=c.closest(".acym__configuration__mail__option").find(".switch-paddle");void 0===n[a.attr("id")]||n[a.attr("id")]?(c.next().removeAttr("disabled"),_.removeClass("disabled").removeAttr("data-acym-tooltip"),l.closest(".acym__tooltip__info").hide()):(1===parseInt(c.val())&&o.trigger("click"),_.addClass("disabled").attr("data-acym-tooltip",l.find(".acym__tooltip__text ").html()),c.next().attr("disabled","true"),l.closest(".acym__tooltip__info").show()),acym_helperTooltip.setTooltip()}function i(e){const t=document.querySelector(`#${e.id}_settings`);t&&t.scrollIntoView({behavior:"smooth",block:"center"}),n()}function n(){t("acym__config__mail__embed__image__blocked","embed_images"),t("acym__config__mail__embed__attachment__blocked","embed_files")}!function(){let t=e('input[name="config[mailer_method]"]');t.on("change",function(){e(".send_settings").hide();let t=e('input[name="config[mailer_method]"]:checked').val();const i=e(`#${t}_settings`);i.length>0&&i.show()}),t.trigger("change")}(),e("#available_ports_check").off("click").on("click",function(t){t.preventDefault();let i=e(this).parent();i.html('<i class="acymicon-circle-o-notch acymicon-spin"></i>'),e.get(ACYM_AJAX_URL+"&ctrl=configuration&task=ports",function(e){i.html(e)})}),e(".acym_autoselect").off("click").on("click",function(){this.select()}),e("#timeoutcheck_action").off("click").on("click",function(t){t.preventDefault();try{e("#timeoutcheck").html('<i class="acymicon-circle-o-notch acymicon-spin"></i>'),e.get(ACYM_AJAX_URL+"&ctrl=configuration&task=detecttimeout",function(t){e("#timeoutcheck").html("Done!")})}catch(e){alert(acym_helper.sprintf(ACYM_JS_TXT.ACYM_MAX_EXEC_TIME_GET_ERROR,e))}}),e("#checkdb_button").off("click").on("click",function(t){t.preventDefault(),e("#checkdb_report").html('<i class="acymicon-circle-o-notch acymicon-spin"></i>'),e.get(ACYM_AJAX_URL+"&ctrl=configuration&task=checkDB",function(t){e("#checkdb_report").html(t)})}),e('input[name="config[auto_bounce]"]').off("change").on("change",function(){e("#acym__configuration__bounce__auto_bounce__configuration").toggle()}),e("#sendorderid").on("change",function(){"rand"===this.value&&alert(ACYM_JS_TXT.ACYM_NO_RAND_FOR_MULTQUEUE)}),function(){let t=e("#acym__configuration__cron__report--send-to"),i=t.attr("placeholder");t.select2({width:"100%",placeholder:i,tags:!0,theme:"foundation",tokenSeparators:[","," "],createTag:function(t){let i=e.trim(t.term);return acym_helper.emailValid(i)?{id:i,text:i,newTag:!0}:null}})}(),e("#acym__configuration__button__license").off("click").on("click",function(){let t=e("#acym__configuration__license-key").val(),i=parseInt(e(this).attr("data-acym-linked"));if(""===t)return alert(ACYM_JS_TXT.ACYM_PLEASE_SET_A_LICENSE_KEY),!1;let n=i?"unlinkLicense":"attachLicense";e('[name="task"]').val(n),e.acymConfigSave(),e("#acym_form").submit()}),e("#acym__configuration__button__cron").off("click").on("click",function(){let t=parseInt(e(this).attr("data-acym-active")),i=t?"deactivateCron":"activateCron";e('[name="task"]').val(i),e("#acym_form").submit()}),function(){let t="";e("#configmultilingual_default").on("change",function(){let i=e(this).val(),n=e("#configmultilingual_languages");n.find('option[value="'+i+'"]').prop("disabled",!0).prop("selected",!1),n.find('option[value="'+t+'"]').prop("disabled",!1),n.select2({theme:"foundation",width:"100%"}),t=i}).trigger("change"),e.acymConfigSave=function(){e('[name="config[sender_info_translation]"]').length>0&&acym_helperSelectionMultilingual.changeLanguage_configuration(acym_helperSelectionMultilingual.mainLanguage),e('input[id^="delayvar"]').trigger("change");let t=e("#configmultilingual_languages").val(),i=e('[name="previous_multilingual_languages"]').val();if(acym_helper.empty(i))return!0;i=i.split(",");let n=acym_helper.empty(t)?i:i.filter(e=>!t.includes(e));return!!acym_helper.empty(n)||(e.each(n,function(t){n[t]=e('#configmultilingual_default option[value="'+n[t]+'"]').text()}),!!acym_helper.confirm(acym_helper.sprintf(ACYM_JS_TXT.ACYM_REMOVE_LANG_CONFIRMATION,n.join(", "))))}}(),function(){let t=e("#acym__configuration__acl__zone");e("#acym__configuration__acl__toggle").off("click").on("click",function(){t.slideToggle()}).trigger("click")}(),acym_helperMailer.setTestCredentialsSendingMethods(),acym_helperMailer.setButtonCopyFromPlugin(),acym_helperMailer.setSynchroExistingUsers(),acym_helperSelectionPage.setSelectionElement(!0,!0,i),n(),acym_helperSelectionMultilingual.init("configuration"),e('[data-task="downloadExportChangesFile"]').on("click",function(){setTimeout(function(){e("#formSubmit")[0].disabled=!1,e('[name="task"]').val("")},5)}),function(){let t=e(".acym__allowed__hosts__select");t.select2({width:"100%",placeholder:t.attr("placeholder"),tags:!0,theme:"foundation",tokenSeparators:[" "],createTag:function(e){let t=jQuery.trim(e.term);return""===t?null:{id:t,text:t}}})}(),acym_helperMailer.displayAuth2Params(),acym_helperMailer.acymailerAddDomains(),acym_helperMailer.displayCnameRecord(),acym_helperMailer.deleteDomain(),acym_helperMailer.domainSuggestion(),acym_helperMailer.updateStatus(),e("#acymailer_domain").on("keypress",function(t){"Enter"===t.key&&(t.preventDefault(),e("#acym__configuration__sending__method-addDomain").trigger("click"))}),jQuery("#acym__configuration__activate__acymailer").off("click").on("click",function(){jQuery('[data-tab-identifier="mail_settings"]').trigger("click"),jQuery("#acymailer").trigger("click")}),function(){const t=e('select[name^="config[acl_"]'),i={},n=e=>e.slice(4,-2);t.each(function(){i[n(e(this).attr("name"))]=e(this).val()}),t.on("change",function(){const t=n(e(this).attr("name"));let a=e(this).val();i[t].includes("all")&&e(this).val().includes("all")&&e(this).val().length>1?a=e(this).val().splice(e(this).val().indexOf("all")-1,1):!i[t].includes("all")&&e(this).val().includes("all")?a=["all"]:0===e(this).val().length&&(a=["all"]),e(this).val(a).trigger("change.select2"),i[t]=a})}(),jQuery('[name="config[embed_files]"]').off("change").on("change",function(){setTimeout(()=>{const e=jQuery("#attachments_position");"1"===jQuery(this).val()?e.css("display","none"):e.css("display","")},10)})});